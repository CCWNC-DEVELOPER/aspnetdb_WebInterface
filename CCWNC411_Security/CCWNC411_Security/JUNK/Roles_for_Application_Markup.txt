<%@ Page Title="" Language="vb" AutoEventWireup="false" MasterPageFile="~/Site.Master" CodeBehind="Roles_for_Application.aspx.vb" Inherits="CCWNC411_Security.Roles_for_Application" %>
<asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" runat="server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">


<p>
Pick an Application To see the list of Roles
</p>
<p>
<%--  DropDownList --%>
    <asp:DropDownList 
        ID="DropDownList_Application" 
        runat="server"
        AppendDataBoundItems="true"
        DataSourceID="SqlDataSource_DropDownList" 
        DataTextField="ApplicationName" 
        DataValueField="ApplicationName" 
        AutoPostBack="true">
    </asp:DropDownList>

    
<%--  ODS for the DropDownList --%>

        <asp:SqlDataSource ID="SqlDataSource_DropDownList" runat="server" 
            ConnectionString="<%$ ConnectionStrings:SHAREPOINT01_aspnetdb %>"        
            ProviderName="<%$ ConnectionStrings:SHAREPOINT01_aspnetdb.ProviderName %>" 
            SelectCommand="SELECT [ApplicationName], [ApplicationId] FROM [aspnet_Applications]" >
        </asp:SqlDataSource>



</p>

<p>

<%--  Controls ------------------------------------------------- --%>


        <asp:Label ID="lbl_Message" runat="server" Text="Label"></asp:Label>
        
</p>
<p>

    <asp:Button ID="btn_GetListOfRolesForTheApplication" 
        runat="server" 
        Text="Get List Of Roles For The Application" />
</p>


<p>

    <asp:Button ID="btn_AddNewRoleToApplication" runat="server" Text="Add New Role To Application" />
    &nbsp;<asp:TextBox ID="txt_NewRoleToAddToApplication" runat="server" Width="354px"></asp:TextBox>



</p>
<p>

    <asp:GridView 
        ID="GridView_RolesInTheApplication" 
        DataSourceID="ods_for_GridView" 
        AutoGenerateColumns="False"
        RunAt="server"  
        AutoGenerateDeleteButton="True" 
        DataKeyNames="RoleName"
        OnRowCommand="GridView_RolesInTheApplication_RowCommand"
        Width="265px">
        <Columns>

            <asp:BoundField DataField="RoleName" HeaderText="RoleName" 
                SortExpression="RoleName" />

        </Columns>
    </asp:GridView>

    <asp:ObjectDataSource 
        ID="ods_for_GridView" 
            runat="server" 
            TypeName="CCWNC411_Security.ns_ROLE.c_ROLE_DL"   
            DataObjectTypeName="CCWNC411_Security.ns_ROLE.c_ROLE_Record" 
            SelectMethod="GetAllRoles_GivenApplicationName" 
            DeleteMethod="DeleteRole" >   
             <SelectParameters>
                <asp:QueryStringParameter Name="ApplicationName"/>
            </SelectParameters>

           <DeleteParameters>
                <asp:QueryStringParameter Name="ApplicationName" />
                <asp:QueryStringParameter Name="RoleName"/>                               
            </DeleteParameters>

      </asp:ObjectDataSource>



</asp:Content>


<%--


 --%>
